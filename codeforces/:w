#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <iostream>
#include <map>
#include <algorithm>
#include <vector>
using namespace std;
#define two(x) (1<<(x))

char s[200010][25];
int n, offset, m;
int p[two(21) + 10];

void update(int &a, int b) {
	if (a > b) a = b;
}

int main() {
	scanf("%d", &n);
	for (int i = 0; i < n; ++ i)
		scanf("%s", s[i]);
	m = strlen(s[0]);
	memset(p, 0x3F, sizeof(p));

	p[1] = 0;
	for (int i = 0; i < n; ++ i) {
		int val = 1, res = p[1] + offset + m;
		for (int j = 0; j < m; ++ j) {
			val = (val << 1) | ((int)s[i][j] - '0');
			if (p[val] != -1) update(res, p[val] + offset + m - j - 1);
		}

		if (i) {
			int k = 0;
			while (k < m && s[i - 1][m - k - 1] == s[i][k]) ++ k;
			offset += m - k;
		}

		val = 0;
		for (int j = 0; j <= m; ++ j) {
			if (j) val = (val << 1) | ((int)s[i][m - j] - '0');
			update(p[val | two(j)], res - offset);
		}
	}

	return 0;
}

